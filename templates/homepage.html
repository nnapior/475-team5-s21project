<html>

<head>
   <script src="scripts.js" type="text/javascript"></script>
   <link rel="stylesheet" type="text/css" href="style.css">
</head>

<body onload="getData()">
   <button id="mainButton" onclick="getData()">Refresh Data</button>
   <br>
   <p><b>Preview Data</b></p>
   Event: <select id="eventSelection" name="eventSelection"></select><br>
   Participant: <select id="participantSelection" name="participantSelection"></select>
   <br><br>
   <div id="output">
   </div>
   <br>
   <div id="exportOptions">
      <p><b>Export</b></p>
      Export: <select id="exportMode" name="exportMode" oninput="showEventCheckboxes(this.value)">
         <option value="all">All Events</option>
         <option value="select">Selected Events</option>
      </select><br>
      <div id="selectedEvents" style="visibility:hidden; position: absolute; z-index=-10">
      </div>
      To: <select id="sheetMode" name="sheetMode" oninput="showSheetSelection(this.value)">
         <option value="new">New Sheet</option>
         <option value="replace">Existing Sheet (Replace)</option>
      </select>
      <br><br>
      <div id="sheetSelection" style="visibility:hidden; position:absolute;z-index:-10">
         <button style="display:inline" onclick="chooseSheet()">Choose Sheet</button>
         <p style="display:inline" id="sheetName">Choose A Sheet</p>
         <br><br>
      </div>
      <button onclick="exportData()">Export To Sheets</button>
   </div>


<div style="    border: 2px solid;
    padding: 2rem;
    margin-top: 2rem;">
        <h1>Import All Data from Sheets to RedCap</h1>
        <button>
            <a href="/import">Import</a>
        </button>
        <div style="width: 30%;">

            {% with message = get_flashed_messages() %}
            {% if message %}
            <h2>Data from these sheets have been imported to RedCap</h2>
            {% for item in message %}
            <h3 style="    border: 2px solid;
            width: 50%;">{{loop.index}}: {{item}}</h3>
            {% endfor %}
            {% endif %}
            {% endwith %}
        </div>
    </div>


</body>

</html>